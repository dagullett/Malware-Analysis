# Malware Analysis

![Screenshot 2024-02-13 204715](https://github.com/dagullett/Malware-Analysis/assets/75142644/c5300183-f995-4ca6-a666-31871ea4641a)

## Introduction

In this project we do a static and dynamic analsys of the malware redline. RedLine (short for RedLine Stealer) is a malicious program that came out during Covid in 2020. This information-stealing variant allows attackers to steal personal and sensitive data such as login credentials, web browsing history, crypto wallets, geographical locations, etc.
In this lab we will:

- Obtain the md5sum has of the redline malware
- Get the header of the redline malware using the pecheck command
- Use PE Tree software to see a GUI of the header
- Investigate redline with Virus Total and Hybrid Analysis

## Obtaining Hash

![Screenshot 2024-02-13 204650](https://github.com/dagullett/Malware-Analysis/assets/75142644/4bc4aa9b-4a71-43a1-95d9-bc56a315b4c3)

The first thing I did was find the hash of the malware. Now you can obtain several hash types such as SHA1 SHA256, and the one I used which is the MD5 hash. We can use this to research the malware to see if it has been found previously.

## Malware Header

![Screenshot 2024-02-13 204549](https://github.com/dagullett/Malware-Analysis/assets/75142644/a9e094b2-96c6-45be-8c21-7fb470711d6d)

Next I ran the pecheck command to find the header information on the virus. This gives more detailed information. Instead of doing a hash search, I could have done a header search as this gives all three hash types. It also gives other information such as the entropy. Entropy is just a fancy way of saying the randomness of a file. Here it shows the entropy of the .text, .rdata, .data, .ndata, and .rsrc files.

![Screenshot 2024-02-13 205310](https://github.com/dagullett/Malware-Analysis/assets/75142644/6779bd6d-3e59-4677-a9a6-c0e46ccb4002)

You can also use the GUI software for a header. This is PE Tree. It provides the same information only in a GUI format.

## Investigation

Now that we have our hash, we can do a some research on the malware. There a several great tools you can use. For this we will use Virus Total and Hybrid Analysis Sandbox. When I searched the hash on Virus Total, it lit up like a Christmas Tree.

![Screenshot 2024-02-13 204715](https://github.com/dagullett/Malware-Analysis/assets/75142644/bc9790ea-a640-47bf-92e6-27f22c5ce091)

![Screenshot 2024-02-13 204752](https://github.com/dagullett/Malware-Analysis/assets/75142644/c2d6fe35-743f-4a87-a7e7-dc3fb6873821)

It's no surprise that this popped up as a known Malware. It's most notably listed as a Trojan virus. It uses techniques to mask itself and steal your personal information. Now that we know what it is, we'll use a sandbox to simulate a dynamic analysis. You could upload the virus to the sandbox and let it run free, but they have a neat search(with the hash ;) ) so we don't have to run the analysis manually. All the hard work is finished.

![Screenshot 2024-02-13 205609](https://github.com/dagullett/Malware-Analysis/assets/75142644/791cb1ff-d126-4c81-8b07-0966c1992104)

Lucky for us, several people have let the virus run lose on different types of OS. You can see what it exactly does on the machine. They give you some detailed analysis of various things it can do.

![Screenshot 2024-02-13 205857](https://github.com/dagullett/Malware-Analysis/assets/75142644/b4745ce8-6a82-4bab-a442-d1eb9f6d1504)

Here is the analysis of the virus itself.

![Screenshot 2024-02-13 211002](https://github.com/dagullett/Malware-Analysis/assets/75142644/e6468ba3-6447-4fca-98c4-74de4df1c96e)

As you can see it does a lot of different things to conceal itself and steal your information.

## Conclusion

This was a lot of fun and I learned a lot dissecting the malware. It scary knowing just what kind of malicous things a malware can do you and your system. Stay safe out there.
